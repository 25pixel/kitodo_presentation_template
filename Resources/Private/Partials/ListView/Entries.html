<f:comment>
<!--
 * (c) Kitodo. Key to digital objects e.V. <contact@kitodo.org>
 *
 * This file is part of the Kitodo and TYPO3 projects.
 *
 * @license GNU General Public License version 3 or later.
 * For the full copyright and license information, please read the
 * LICENSE.txt file that was distributed with this source code.
-->
</f:comment>
<html xmlns:f="http://typo3.org/ns/TYPO3/CMS/Fluid/ViewHelpers"
      xmlns:kitodo="http://typo3.org/ns/Kitodo/Dlf/ViewHelpers"
      data-namespace-typo3-fluid="true">

<f:for each="{documentList}" key="entryIndex" as="entry" iteration="docIterator">
    <f:variable name="currentPage" value="{widgetPage.currentPage - 1}" />
    <f:variable name="pageOffset" value="{settings.limit * currentPage}" />
    <f:variable name="allDocuments" value="{documents->f:count()}" />
    <f:variable name="numDocuments" value="{pageOffset + settings.limit}" />

    <li value="{settings.limit * pageOffset + docIterator.index}">
        <div class="tx-dlf-listview-thumbnail">
            <img alt="{metadataList.{entryIndex}.thumbnail.alt}" src="{metadataList.{entryIndex}.thumbnail.src}" />
        </div>

        <dl>
            <f:for each="{metadataList.{entryIndex}.metadata}" key="indexName" as="field">
                <stdWrap wrap="{field.wrap}">
                    <kitodo:stdWrap wrap="{field.label.wrap}">{field.label.value}</kitodo:stdWrap>
                    <f:for each="{field.values}" as="value">
                        <stdWrap wrap="{value.wrap}">
                            <f:if condition="{indexName} == 'title'">
                                <f:then>
                                    <f:if condition="{logicalPage}">
                                        <f:then>
                                            <f:variable name="params" value="{
                                                        'tx_dlf[id]':entry.uid,
                                                        'tx_dlf[page]':entry.page,
                                                        'tx_dlf[logicalPage]':logicalPage}" />
                                        </f:then>
                                        <f:else>
                                            <f:variable name="params" value="{
                                                            'tx_dlf[id]':entry.uid,
                                                            'tx_dlf[page]':entry.page}" />
                                        </f:else>
                                    </f:if>

                                    <f:link.page pageUid="{settings.targetPid}"
                                                 additionalParams="{params}">
                                        {value.value}
                                    </f:link.page>
                                </f:then>
                                <f:else>
                                    {value.value}
                                </f:else>
                            </f:if>
                        </stdWrap>
                    </f:for>
                </stdWrap>
            </f:for>
        </dl>

        <div class="tx-dlf-listview-preview">{entry.preview}</div>

        <ol>
            <f:render partial="ListView/SubEntries" arguments="{_all}" />
        </ol>

        <div>
            <f:if condition="{settings.basketButton} && {settings.targetBasket}">
                <f:link.page pageUid="{settings.targetBasket}"
                             additionalParams="{'tx_dlf[id]':entry.uid, 'tx_dlf[startpage]':entry.page, 'tx_dlf[addToBasket]':'list'}">
                    <f:translate key="AddToBasket"/>
                </f:link.page>
            </f:if>
        </div>
    </li>
</f:for>
